import{r as m,j as o}from"./react-DjxdCBQ7.js";import{c as Ne}from"./react-dom-CtcbTiac.js";import{D as Te}from"./dexie-B9ZPFDpd.js";import{u as Oe,M as je,a as ne}from"./material-react-table-o87BFWu_.js";import{P as C}from"./prop-types-DwKRF41C.js";import{P as Pe}from"./pptxgenjs-BJtfkN45.js";import{aC as Ie,ab as re,ac as se,ad as le,aD as Ee,ae as ce,_ as A,$,aE as Ae,f as H,aF as De,aG as Fe,B as J,a0 as ve,a6 as de,I as ue,o as pe,aH as L,h as Re,ar as Le,am as ze,aI as $e,a7 as ke}from"./@mui-eQcq_L2n.js";/* empty css                    */import"./scheduler-CzFDRTuY.js";import"./@tanstack-CmWnwvTR.js";import"./highlight-words-DHKmS53s.js";import"./jszip-aWo5x_XD.js";import"./clsx-B-dksMZM.js";import"./@emotion-D6YYa15c.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./@babel-6xVxzmvl.js";import"./stylis-YPZU7XtI.js";import"./react-transition-group-CFjUUMFn.js";import"./dom-helpers-D0mFdbeO.js";import"./@popperjs-BQBsAJpH.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function a(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(e){if(e.ep)return;e.ep=!0;const n=a(e);fetch(e.href,n)}})();const B=new Te("PhotoDatabase");B.version(1).stores({photos:"++id, numb"});function he(t){try{return B.photos.add({numb:t.numb,photoNumb:t.photoNumb,copyOf:t.copyOf,hasCopy:null,description:t.description,image:t.blob})}catch(i){return console.log(i),-1}}async function z(t){try{const i=await B.photos.update(t.id,{numb:t.numb,photoNumb:t.photoNumb,copyOf:t.copyOf,hasCopy:t.hasCopy,description:t.description});return i>0?i:(console.log(`No photo updated with id ${t.id} for photo ${t.photoNumb}`),0)}catch(i){return console.log(i),-1}}async function Be(t){try{return await B.photos.delete(t),1}catch(i){return console.log(i),-1}}async function He(){try{return await B.photos.clear(),1}catch(t){return console.log(t),-1}}async function Me(){return await B.photos.toArray()}let K,V,Z,_,q,Q,S,E="A",F=1;function Ge(){K=localStorage.getItem("bagNumb"),V=localStorage.getItem("c1acc")===null?!1:JSON.parse(localStorage.getItem("c1acc")),Z=localStorage.getItem("incidentNumb"),_=localStorage.getItem("location").toUpperCase(),q=localStorage.getItem("postalCode"),q?Q=`                                   SINGAPORE ${q}`:Q=""}function ee(t){return String.fromCharCode(t.charCodeAt(0)+1)}function U(t){const i=t.naturalWidth,a=t.naturalHeight;let r;return i>a?r=i/a:r=a/i,r}function Ue(){S=new Pe,S.subject="Fire Report",S.theme={headFontFace:"Arial",bodyFontFace:"Arial"},S.defineLayout({name:"A4",width:7.5,height:11.0244094}),S.layout="A4"}const k=t=>{t.addText("CONFIDENTIAL",{y:.06,w:"100%",h:.29,align:"center",bold:!0,fontSize:12}),t.addText([{text:`INCIDENT NUMBER: /${Z}`,options:{breakLine:!0}},{text:`LOCATION OF FIRE: ${_}`,options:{breakLine:!0}},{text:Q}],{x:.6653543,y:.4291339,h:.6968504,w:5.5472441,fontSize:12}),t.addText(`ANNEX ${E}`,{x:6.2165354331,y:.4291339,h:.3425197,w:1.14173,fontSize:15,bold:!0,underline:!0}),t.addText([{text:`${E}-${F}`,options:{breakLine:!0}},{text:"CONFIDENTIAL"}],{y:10.429134,w:"100%",h:.492126,bold:!0,fontSize:12,align:"center"})},W=(t,i)=>{k(t),t.addShape(S.shapes.RECTANGLE,{x:.4173228,y:1.511811,w:6.8346457,h:8.7559055,line:{width:2.25}}),t.addShape(S.shapes.LINE,{x:.4173228,y:9.2637795,w:6.8188976,h:0,line:{width:2.25}});let a,r,e;i?(t.addShape(S.shapes.LINE,{x:3.334646,y:9.2637795,w:0,h:1,line:{width:2.25}}),t.addShape(S.shapes.RECTANGLE,{x:3.58268,y:9.5393701,w:.3346457,h:.2519685,line:{width:1}}),t.addText("THE AFFECTED AREA",{x:4,y:9.5393701,w:1.41732,h:.2519685,fontSize:8}),t.addShape(S.shapes.OVAL,{x:3.58268,y:9.8582677,w:.3346457,h:.3346457,line:{width:1.5,color:"#FC0128"}}),t.addText("AREA OF FIRE ORIGIN",{x:4,y:9.8582677,w:1.41732,h:.2519685,fontSize:8}),e=9.2637795,a=.4173228,r=3.354331):(t.addShape(S.shapes.LINE,{x:4.1653543,y:9.2637795,w:0,h:1,line:{width:2.25}}),e=9.3385827,a=.5826772,r=4.3188976),t.addText("NOT DRAWN TO SCALE",{x:.6338583,y:8.9685039,w:1.480315,h:.23622,fontSize:8,color:"919191",underline:!0}),t.addText("SKETCH:",{x:a,y:e,h:.2598425,w:.826772,fontSize:10,underline:!0}),t.addText("LEGEND:",{x:r,y:e,h:.2598425,w:.826772,fontSize:10,underline:!0}),E=ee(E)};function We(t){let i={bold:!0,align:"center"},a=[[{text:"Photo",options:i},{text:"Photo UID No.",options:i},{text:"Descriptions",options:i}]];t.forEach(e=>{e.photoUIDNumb=`${K?`${K}/`:""}${e.photoNumb}`,e.isLandscape=e.image.width>e.image.height,a.push([{text:e.displayedNumb,options:{align:"center"}},{text:e.photoUIDNumb,options:i},e.description])}),console.log(a);let r=S.addSlide();k(r),r.addTable(a,{x:.4173228,y:2.200787,colW:[1.240157,1.92913,3.58268],rowH:.488189,h:8,valign:"middle",border:{type:"solid"},autoPage:!0,autoPageRepeatHeader:!0,autoPageSlideStartY:2.200787}),r.addText("TABLE OF PHOTO-LOG",{x:.4094488,y:1.673228,h:.3897638,w:3.165354,fontSize:18}),F++,r.newAutoPagedSlides.forEach(e=>{k(e),F++,e.addText("TABLE OF PHOTO-LOG",{x:.4094488,y:1.673228,h:.3897638,w:3.165354,fontSize:18})}),E=ee(E),F=1}function Ye(t){const i={l1:1.326772,l2:5.9094488,p:2.8622},a={l:1.251969,p1:.1653543,p2:3.85827,pc:2.07874},r={l:5.0748031,p:3.484252};for(let e=0;e<t.length;e++){let n=S.addSlide();k(n);const h=t[e],f=U(h.image);if(h.isLandscape){const d=r.l*(1/f);n.addImage({x:a.l,y:i.l1+(3.5-d),w:r.l,h:d,path:h.image.src,sizing:{type:"contain",w:r.l,h:d}});const p=4.8937008,T=.2007874,w={x:1.251969,w:2.5,h:T,fontSize:12,bold:!0,margin:0},j={x:"50%",w:2.574803,h:T,fontSize:12,bold:!0,margin:0,align:"right"},N={x:1.2519685,h:.708661,w:5.0748031,fontSize:12,margin:0,valign:"top"};if(n.addText(`PHOTO ${h.numb}`,{...w,y:p}),n.addText(h.photoUIDNumb,{...j,y:p}),n.addText(h.description,{...N,y:5.0984252}),e<t.length-1&&t[e+1].isLandscape&&!t[e+1].hasCopy){e++;const x=t[e],l=U(x.image),y=r.l*(1/l);n.addImage({x:a.l,y:i.l2+(3.5-y),w:r.l,h:y,path:x.image.src,sizing:{type:"contain",w:r.l,h:y}});const P=9.488189;n.addText(`${x.copyOf?"COPY OF":""} PHOTO ${x.numb}`,{...w,y:P}),n.addText(x.photoUIDNumb,{...j,y:P}),n.addText(x.description,{...N,y:9.6929134})}}else{let d=h,p=f;k(n);const T=7.5590551,w=.2007874,j=1.712598,N=1.77165,x={w:r.p,h:r.p*p},l={y:T,h:w,fontSize:12,bold:!0,margin:0},y={y:7.7598425,h:.9094488,w:r.p,valign:"top",fontSize:12,margin:0};if(e==t.length-1||t[e+1].isLandscape||t[e+1].hasCopy)n.addImage({...x,x:a.pc,y:i.p+(4.645669-x.h),path:d.image.src,sizing:{type:"contain",...x}}),n.addText(`PHOTO ${d.numb}`,{...l,x:a.pc,w:j}),n.addText(d.photoUIDNumb,{...l,x:3.791339,w:N,align:"right"}),n.addText(d.description,{...y,x:a.pc});else{let P=a.p1,v=1.877953;for(let I=0;I<2;I++)n.addImage({...x,x:P,y:i.p+(4.645669-x.h),path:d.image.src,sizing:{type:"contain",...x}}),n.addText(`${d.copyOf?"COPY OF ":""}PHOTO ${d.numb}`,{...l,x:P,w:j}),n.addText(d.photoUIDNumb,{...l,x:v,w:N,align:"right"}),n.addText(d.description,{...y,x:P}),P=a.p2,v=5.5708661,d=t[e+1],Math.abs(U(d.image)-p)>1e-4&&(p=U(d.image));e++}}F++}F=1,E=ee(E)}async function Xe(t){Ge(),Ue(),E="A",F=1;const i=.4173228;if(!V){let r=9.6732283,e=4.511811,n={x:i,y:r,w:3.732283,h:.3425197,bold:!0,align:"center",fontSize:15},h={x:5.07874,y:r,w:1.389764,h:.2519685,fontSize:8},f={x:e,y:r,w:.4173228,h:.2519685},d=S.addSlide();W(d,!1),d.addText("LOCATION PLAN",n),d.addShape(S.shapes.RECTANGLE,{...f,line:{width:1.5,color:"#FF0000"}}),d.addText("INCIDENT SITE",h);let p=S.addSlide();W(p,!1),p.addText("SITE PLAN",n),p.addShape(S.shapes.RECTANGLE,{...f,line:{width:1.5},fill:{type:"solid",color:"#919191"}}),p.addText("THE AFFECTED AREA",h)}let a=S.addSlide();if(W(a,!0),a.addText([{text:"LAYOUT PLAN OF THE",options:{breakLine:!0}},{text:"AFFECTED AREA"}],{x:i,y:9.511811,w:2.905512,h:.492126,bold:!0,align:"center",fontSize:12}),!V){We(t);let r=S.addSlide();k(r),W(r,!0),r.addText([{text:"PHOTO-LOG",options:{breakLine:!0,fontSize:14}},{text:`Photos 1-${t.at(-1).numb}`,options:{fontSize:12}}],{x:i,y:9.511811,w:2.905512,h:.492126,bold:!0,align:"center"})}Ye(t),S.writeFile({fileName:`${Z.replace("/","-")}-${_}`})}const qe=Ie("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});class M{constructor(i,a,r,e,n=-1,h=null,f=null){this.id=n,this.image=new Image,this.image.src=URL.createObjectURL(i),this.photoNumb=r.toString(),this.description=e,this.copyOf=h,this.hasCopy=f,this.blob=new Blob([i]),this.numb=a,this.displayedNumb=(h?"Copy of ":"")+a.toString()}updateNumb(i){this.numb=i,this.displayedNumb=(this.copyOf?"Copy of ":"")+i.toString()}createPureCopy(){return new M(this.image,this.numb,this.photoNumb,this.description,this.id,this.copyOf,this.hasCopy)}createCopy(){return new M(this.blob,this.numb,this.photoNumb,"",-1,this.id)}getOrientation(){return this.image.width>this.image.height?"landscape":"portrait"}}me.propTypes={open:C.bool,setOpen:C.func,data:C.array,setData:C.func,deleteId:C.number,handleDelete:C.func,handleDeleteAll:C.func};function me({open:t,setOpen:i,data:a,setData:r,deleteId:e,handleDelete:n,handleDeleteAll:h}){const f=()=>{i(!1)},d=()=>{let p=[...a];a[e].hasCopy&&(p=n(a.find(T=>T.id==a[e].hasCopy),p)),p=n(a[e],p),r(p)};return o.jsx(o.Fragment,{children:o.jsxs(re,{open:t,onClose:f,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[o.jsx(se,{id:"alert-dialog-title",children:`Permanently delete ${e>0?"photo":"all"}?`}),o.jsx(le,{children:o.jsxs(Ee,{id:"alert-dialog-description",children:["Do you really want to delete ",e<0?"all the photos":"the photo","? This process cannot be undone."]})}),o.jsxs(ce,{children:[o.jsx(A,{onClick:f,children:"Cancel"}),o.jsx(A,{onClick:()=>{e<0?(h(),f()):e>0?(d(),f()):console.log("ERROR: Invalid deleteId")},autoFocus:!0,color:"error",children:"Delete"})]})]})})}ge.propTypes={openAddForm:C.bool,setOpenAddForm:C.func,data:C.array,setData:C.func};function ge({openAddForm:t,setOpenAddForm:i,data:a,setData:r}){const[e,n]=m.useState(new File([""],"empty")),[h,f]=m.useState(""),[d,p]=m.useState(""),[T,w]=m.useState(!0),j=l=>{l||(p("error"),f("File could not be uploaded."),w(!0));let y=l.name.split(".");return["jpeg","jpg","png","raw","heic"].indexOf(y[y.length-1])<0?(p("error"),f(`File "${l.name}" has invalid file format.`),w(!0),!1):(p("success"),f(`File "${l.name}" uploaded`),w(!1),!0)},N=l=>{j(l)&&n(l)},x=()=>{n(new File([""],"empty")),w(!0),f(""),p(""),i(!1)};return o.jsxs(re,{open:t,onClose:x,PaperProps:{component:"form",onSubmit:l=>{l.preventDefault();const y=new FormData(l.currentTarget),P=Object.fromEntries(y.entries()),v=a.length===0?0:a.at(-1).numb;let I=new M(e,+v+1,P.photoNumb,P.description);he(I).then(Y=>{I.id=Y,r([...a,I])}),x()}},fullWidth:!0,children:[o.jsx(se,{children:"Add Photo"}),o.jsxs(le,{children:[o.jsx($,{autoFocus:!0,id:"photoNumb",name:"photoNumb",required:!0,margin:"dense",label:"Photo Number",variant:"standard",type:"text",autoComplete:"off",fullWidth:!0}),o.jsx($,{id:"description",name:"description",margin:"dense",label:"Description",variant:"standard",type:"text",autoComplete:"off",fullWidth:!0,multiline:!0}),o.jsxs(A,{component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:o.jsx(Ae,{}),sx:{marginTop:"8px",marginBottom:"4px"},children:["Upload file",o.jsx(qe,{type:"file",onChange:l=>{try{N(l.target.files[0])}catch(y){console.log(y),N(null)}}})]}),o.jsxs(H,{color:d,children:[" ",h," "]})]}),o.jsxs(ce,{children:[o.jsx(A,{onClick:x,children:"Cancel"}),o.jsx(A,{type:"submit",disabled:T,children:"Submit"})]})]})}fe.propTypes={error:C.object,setError:C.func,setClearAll:C.func,setCreateStack:C.func};function fe({error:t,setError:i,setClearAll:a,setCreateStack:r}){const[e,n]=m.useState([]),[h,f]=m.useState({}),[d,p]=m.useState(""),[T,w]=m.useState(!1),[j,N]=m.useState(!1),[x,l]=m.useState(0);m.useEffect(()=>{Me().then(u=>{let c=u.map(s=>new M(s.image,s.numb,s.photoNumb,s.description,s.id,s.copyOf,s.hasCopy));n(c.sort((s,b)=>s.numb==b.numb?s.copyOf?1:-1:s.numb-b.numb))}),f({pageSize:localStorage.getItem("pageSize")?localStorage.getItem("pageSize"):25,pageIndex:0})},[]),m.useEffect(()=>{Object.keys(h).length!==0&&localStorage.setItem("pageSize",h.pageSize)},[h]);const y=m.useCallback(async(u,c,s,b)=>{if(c[u]==b)return;let g=[...e];g[s][u]=b,z(g[s]),u=="photoNumb"&&(c.hasCopy||c.copyOf)&&(s=c.hasCopy?s+1:s-1,g[s][u]=b,z(g[s])),n(g)},[e]),P=m.useMemo(()=>[{accessorKey:"displayedNumb",header:"#",enableEditing:!1,enableResizing:!1,grow:!1,size:50},{accessorKey:"photoNumb",header:"Photo Number",required:!0,muiEditTextFieldProps:({cell:u,row:c})=>({type:"text",required:!0,error:!!d,helperText:d,onChange:s=>{s.target.value?d&&p(""):p("Required")},onBlur:s=>{d||y(u.column.id,c.original,+c.id,s.target.value)}})},{accessorKey:"description",header:"Description",required:!0,enableResizing:!1,grow:10,muiEditTextFieldProps:({cell:u,row:c})=>({type:"text",onBlur:s=>{y(u.column.id,c.original,+c.id,s.target.value)}})}],[y,d]),v=u=>{let c=u.createCopy();he(c).then(s=>{c.id=s;const b=e.indexOf(u);let g=[...e];g[b].hasCopy=s,z(u),g.splice(b+1,0,c),n(g)})},I=(u,c={})=>{u||(u=e.indexOf(c.original)),l(u),N(!0)},Y=(u,c)=>{Be(u.id);let s=c.filter(b=>u.id!=b.id);if(u.copyOf){const b=s.findIndex(g=>g.id==u.copyOf);return s[b].hasCopy=null,z(s[b]),s}else{let b=!1;for(let g=u.numb,O=c.indexOf(u);O<s.length;g++,O++)s[O].copyOf&&!b?(g--,s[O].updateNumb(g),b=!0):(s[O].updateNumb(g),b=!1),z(s[O]);return s}},ye=()=>{He(),n([]),i({incidentNumb:"",bagNumb:"",location:"",postalCode:"",numbEntry:""}),a(!0)},Ce=Oe({columns:P,data:e,enableEditing:!0,editDisplayMode:"cell",enableRowActions:!0,enableRowOrdering:!0,enableSorting:!1,enableColumnResizing:!0,autoResetPageIndex:!1,initialState:{columnPinning:{right:["mrt-row-actions"]}},layoutMode:"grid-no-grow",displayColumnDefOptions:{"mrt-row-actions":{grow:!1}},state:{pagination:h},onPaginationChange:f,muiRowDragHandleProps:({table:u})=>({onDragEnd:()=>{const{draggingRow:c,hoveredRow:s}=u.getState();if(s&&c){if(s===c||e[s.index].numb===e[c.index].numb)return;let b=c.index,g=s.index,O=[...e],D=1;if(e[c.index].hasCopy?D=2:e[c.index].copyOf&&(D=2,b--),e[s.index].hasCopy&&g>b?D===2?g+=1:D===1&&g--:e[s.index].copyOf&&g<e.length-1&&(D===2?g+=2:g<b&&g++),g===b)return;const Se=b>g?g:g-D+1;O.splice(Se,0,...O.splice(b,D));const oe=e[s.index].copyOf?e[s.index].numb+1:e[s.index].numb,ae=e[c.index].numb;let X=!1;for(let G=Math.min(oe,ae),tt=Math.max(oe,ae),R=Math.min(b,g),we=e.length;R<we;G++,R++)O[R].copyOf&&!X?(G--,O[R].updateNumb(G),X=!0):(O[R].updateNumb(G),X=!1),z(O[R]);n(O)}}}),renderRowActionMenuItems:({row:u,table:c})=>[o.jsx(ne,{icon:o.jsx(De,{}),label:"Create Copy",disabled:!!(u.original.hasCopy||u.original.copyOf),onClick:()=>{v(u.original)},table:c},"add"),o.jsx(ne,{icon:o.jsx(Fe,{}),label:"Delete",onClick:()=>I(0,u),table:c},"delete")],renderBottomToolbarCustomActions:()=>o.jsxs(J,{sx:{display:"flex",gap:"1rem",alignItems:"center"},children:[o.jsx(A,{color:"primary",variant:"contained",onClick:()=>{let u=!1,c={...t};e.length===0?(c={...c,numbEntry:"add at least one photo"},u=!0):c={...c,numbEntry:""},localStorage.getItem("incidentNumb")||(c={...c,incidentNumb:"Please key in the incident number"}),localStorage.getItem("location")||(c={...c,location:"Please key in the location"});for(const s of Object.values(c))if(s){u=!0,i(c),r(!0);return}u?r(!0):Xe(e)},children:"Generate Report"}),o.jsx(A,{color:"error",variant:"contained",onClick:()=>I(-1),disabled:e.length==0,children:"Delete All"})]}),renderTopToolbarCustomActions:()=>o.jsx(A,{variant:"contained",onClick:()=>{w(!0)},children:"Upload Photo"}),muiDetailPanelProps:()=>({sx:u=>({backgroundColor:u.palette.mode==="dark"?"rgba(255,210,244,0.1)":"rgba(0,0,0,0.1)"})}),renderDetailPanel:({row:u})=>u.original.copyOf?null:o.jsx(J,{sx:{display:"flex",margin:"auto",width:"96vw",justifyContent:"center",alignItems:"center"},children:o.jsx("img",{src:u.original.image.src,style:{width:"25%"}})})});return o.jsxs(o.Fragment,{children:[o.jsx(je,{table:Ce}),o.jsx(ge,{data:e,setData:n,openAddForm:T,setOpenAddForm:w}),o.jsx(me,{open:j,setOpen:N,data:e,setData:n,deleteId:x,handleDelete:Y,handleDeleteAll:ye})]})}const Je=()=>{const[t,i]=m.useState(!1);return m.useEffect(()=>{navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then(a=>{a?console.log("Persistent Storage Granted"):(i(!0),setTimeout(()=>{i(!1)},2e4))})},[]),o.jsx(ve,{in:t,children:o.jsx(de,{severity:"warning",action:o.jsx(ue,{"aria-label":"close",color:"inherit",size:"small",onClick:()=>{i(!1)},children:o.jsx(pe,{fontSize:"inherit"})}),sx:{mb:2},children:"Persistent storage was not granted to the website. Hence, there is a chance that the data saved will be wiped by the browser should the website not be accessed after a prolonged period of time."})})},te={incidentNumb:new RegExp("^20\\d{6}/\\d{4}$"),bagNumb:new RegExp("^\\d{4}$"),postalCode:new RegExp("^\\d{6}$")},Ke={incidentNumb:"Please use the format YYYYMMDD/XXXX",bagNumb:"Please ensure that it is a 4 digit number",postalCode:"Please ensure that it is a 6 digit number"},Ve={incidentNumb:Qe,bagNumb:Ze,postalCode:_e};function ie(t){localStorage.setItem(t.target.id,t.target.value)}function Qe(t){return te.incidentNumb.test(t)?!isNaN(Date.parse(`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)}`)):!1}function Ze(t){return te.bagNumb.test(t)}function _e(t){return te.postalCode.test(t)}be.propTypes={clearAll:C.bool,setClearAll:C.func,error:C.object,setError:C.func};function be({clearAll:t,setClearAll:i,error:a,setError:r}){const[e,n]=m.useState(""),[h,f]=m.useState(""),[d,p]=m.useState(""),[T,w]=m.useState(""),[j,N]=m.useState(!1);m.useEffect(()=>{n(localStorage.getItem("incidentNumb")?localStorage.getItem("incidentNumb"):""),f(localStorage.getItem("bagNumb")?localStorage.getItem("bagNumb"):""),p(localStorage.getItem("location")?localStorage.getItem("location"):""),w(localStorage.getItem("postalCode")?localStorage.getItem("postalCode"):""),N(JSON.parse(localStorage.getItem("c1acc")===null)?!1:JSON.parse(localStorage.getItem("c1acc")))},[]),m.useEffect(()=>{t&&(localStorage.clear(),n(""),f(""),p(""),w(""),N(!1),i(!1))},[t,i]);function x(l){const y=l.target.id;if(l.target.value.length===0){r({...a,[y]:""});return}Ve[y](l.target.value)?(ie(l),r({...a,[y]:""})):r({...a,[y]:Ke[y]})}return o.jsxs(J,{sx:{width:"100%",maxWidth:"80vw",flexGrow:1,marginBottom:"25px",textAlign:"center"},children:[o.jsx(H,{variant:"h2",gutterBottom:!0,marginTop:"50px",children:" Fire Report Generator "}),o.jsxs(L,{container:!0,spacing:2,children:[o.jsx(L,{size:4,children:o.jsx($,{id:"incidentNumb",label:"Incident Number",variant:"standard",fullWidth:!0,required:!0,value:e,autoComplete:"off",onChange:l=>{n(l.target.value)},onBlur:l=>{x(l)},error:!!a.incidentNumb,helperText:a.incidentNumb})}),o.jsx(L,{size:4,children:o.jsx($,{id:"bagNumb",label:"Evidence Bag Number",variant:"standard",fullWidth:!0,value:h,autoComplete:"off",onChange:l=>{f(l.target.value)},onBlur:l=>{x(l)},error:!!a.bagNumb,helperText:a.bagNumb})}),o.jsxs(L,{size:4,sx:{alignItems:"center"},children:[o.jsx(H,{sx:{alignItems:"center"},children:"Report Type:"}),o.jsxs(Re,{direction:"row",spacing:1,sx:{justifyContent:"center",alignItems:"center",width:"100%"},children:[o.jsx(H,{children:"Full Report"}),o.jsx(Le,{checked:j,onChange:()=>{N(!j),localStorage.setItem("c1acc",JSON.stringify(!j))}}),o.jsx(H,{children:"C1 Accidental Report"})]})]}),o.jsx(L,{size:8,children:o.jsx($,{id:"location",label:"Location",variant:"standard",fullWidth:!0,required:!0,autoComplete:"off",value:d,onChange:l=>{p(l.target.value)},onBlur:l=>{l.target.value||r({...a,location:""}),ie(l)},error:!!a.location,helperText:a.location})}),o.jsx(L,{size:4,children:o.jsx($,{id:"postalCode",label:"Postal Code",variant:"standard",fullWidth:!0,value:T,autoComplete:"off",slotProps:{input:{startAdornment:o.jsx(ze,{position:"start",children:"Singapore"})}},onChange:l=>{w(l.target.value)},onBlur:l=>{x(l)},error:!!a.postalCode,helperText:a.postalCode})})]})]})}const xe=({error:t,createStack:i,setCreateStack:a})=>{const[r,e]=m.useState(!1),[n,h]=m.useState("");m.useEffect(()=>{if(i)if(r)e(!1);else{let d="Please ensure that";for(const[p,T]of Object.entries(t))if(p!=="numbEntry"&&T){d=d+" the input field at the top is filled up correctly";break}if(t.numbEntry&&(d=d+` ${d!=="Please ensure that"?"and":""} there is at least one photo entry`),d==="Please ensure that")return;h(d+"."),e(!0),a(!1)}},[t,r,i,a]);const f=(d,p)=>{p!=="clickaway"&&e(!1)};return o.jsx(o.Fragment,{children:o.jsx($e,{open:r,autoHideDuration:1e4,onClose:f,anchorOrigin:{vertical:"top",horizontal:"center"},children:o.jsxs(de,{severity:"error",action:o.jsx(o.Fragment,{children:o.jsx(ue,{"aria-label":"close",color:"inherit",onClick:f,children:o.jsx(pe,{})})}),children:[o.jsx(ke,{children:"Report could not be generated"}),n]})},n||void 0)})};xe.propTypes={error:C.object,createStack:C.bool,setCreateStack:C.func};function et(){const[t,i]=m.useState(!1),[a,r]=m.useState({incidentNumb:"",bagNumb:"",location:"",postalCode:"",numbEntry:""}),[e,n]=m.useState(!1);return o.jsxs(o.Fragment,{children:[o.jsx(Je,{}),o.jsx("div",{className:"menu",children:o.jsx(be,{clearAll:t,setClearAll:i,error:a,setError:r})}),o.jsx(fe,{error:a,setError:r,setClearAll:i,setCreateStack:n}),o.jsx(xe,{error:a,createStack:e,setCreateStack:n})]})}Ne(document.getElementById("root")).render(o.jsx(m.StrictMode,{children:o.jsx(et,{})}));
